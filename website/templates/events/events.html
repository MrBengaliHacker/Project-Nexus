{% extends 'base.html' %}
{% block content %}
<div class="max-w-5xl mx-auto p-4">
  <h2 class="text-2xl font-bold mb-4">Events</h2>
  <div class="flex justify-between items-center mb-4">
    <form method="get" class="flex gap-2">
      <input type="text" name="q" placeholder="Search events..." class="border rounded p-2" value="{{ request.args.get('q', '') }}">
      <select name="type" class="border rounded p-2">
        <option value="upcoming">Upcoming</option>
        <option value="past">Past</option>
      </select>
      <button type="submit" class="bg-blue-600 text-white px-3 py-1 rounded">Filter</button>
    </form>
    {% if current_user.role in ['faculty', 'admin', 'cr'] %}
      <a href="{{ url_for('events.event_create') }}" class="bg-green-600 text-white px-4 py-2 rounded">+ Create Event</a>
    {% endif %}
  </div>
  <div>
    <h3 class="text-xl font-semibold mt-6 mb-2">Upcoming Events</h3>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      {% for event in upcoming_events %}
        <div class="border rounded-lg p-4 bg-white shadow">
          {% if event.file_url %}
            <img src="{{ event.file_url }}" alt="Poster" class="h-32 w-full object-cover mb-2 rounded">
          {% endif %}
          <h4 class="font-bold text-lg mb-1">{{ event.title }}</h4>
          <div class="text-sm text-gray-600 mb-1">{{ event.start_time.strftime('%b %d, %Y %I:%M %p') }} - {{ event.end_time.strftime('%b %d, %Y %I:%M %p') }}</div>
          <div class="text-sm text-gray-700 mb-1">{{ event.location }}</div>
          <div class="text-xs text-blue-700 mb-2">{{ event.category }}</div>
          <a href="{{ url_for('events.event_details', event_id=event.id) }}" class="text-blue-600 hover:underline">View Details</a>
        </div>
      {% else %}
        <div class="col-span-full text-gray-500">No upcoming events.</div>
      {% endfor %}
    </div>
    <h3 class="text-xl font-semibold mt-8 mb-2">Past Events</h3>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      {% for event in past_events %}
        <div class="border rounded-lg p-4 bg-gray-50">
          {% if event.file_url %}
            <img src="{{ event.file_url }}" alt="Poster" class="h-32 w-full object-cover mb-2 rounded">
          {% endif %}
          <h4 class="font-bold text-lg mb-1">{{ event.title }}</h4>
          <div class="text-sm text-gray-600 mb-1">{{ event.start_time.strftime('%b %d, %Y %I:%M %p') }} - {{ event.end_time.strftime('%b %d, %Y %I:%M %p') }}</div>
          <div class="text-sm text-gray-700 mb-1">{{ event.location }}</div>
          <div class="text-xs text-blue-700 mb-2">{{ event.category }}</div>
          <a href="{{ url_for('events.event_details', event_id=event.id) }}" class="text-blue-600 hover:underline">View Details</a>
        </div>
      {% else %}
        <div class="col-span-full text-gray-500">No past events.</div>
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}
